# utils/helpers.py
import discord

# --- 帮助文档数据配置 ---
HELP_DATA = {
    "🐱 市民中心 (基础)": {
        "icon": "🆔",
        "cmds": {
            "/市民 注册 [名字]": "【必做】办理入住手续，随机生成品种花色",
            "/市民 档案": "查看你的身份证、资产、称号和配饰",
            "/魔法屋 洗点": "花费喵币重塑你的品种和花色",
            "/改名卡": "使用改名卡修改昵称 (需在商店购买)"
        }
    },
    "🚜 喵喵农场 (挂机)": {
        "icon": "🌾",
        "cmds": {
            "/农场 查看": "查看作物生长进度条",
            "/农场 种植 [作物名]": "购买种子并播种",
            "/农场 收获": "一键收割所有成熟作物换取喵币",
            "/农场 偷菜 [目标]": "潜入别人的农场窃取作物 (小心狗！)",
            "/农场 扩建": "花费喵币开垦更多土地 (上限9块)"
        }
    },
    "📈 喵尔街股市 (博弈)": {
        "icon": "📊",
        "cmds": {
            "/股市 行情": "查看所有股票实时价格和涨跌幅",
            "/股市 买入 [代码] [数]": "抄底！购买股票",
            "/股市 卖出 [代码] [数]": "套现！卖出股票",
            "/股市 投资组合": "查看你的持仓和净资产",
            "/股市 融资/还款": "向黑帮借贷或还钱 (小心破产！)"
        }
    },
    "🎲 喵喵大富翁 (冒险)": {
        "icon": "🏰",
        "cmds": {
            "/大富翁 投骰子": "【核心】掷骰子移动，触发事件或买房",
            "/大富翁 资产": "查看你名下的地产等级",
            "/大富翁 升级 [地块]": "升级建筑以收取更高租金",
            "/大富翁 道具 [操作]": "查看或使用路障、遥控骰子等",
            "/大富翁 保释": "花钱立刻离开禁闭室"
        }
    },
    "🛍️ 商业街 (消费)": {
        "icon": "👜",
        "cmds": {
            "/商店 列表": "查看今日出售的道具、化肥和配饰",
            "/商店 购买 [物品]": "消费喵币购买物品",
            "/背包 查看": "查看你拥有的所有物品",
            "/背包 使用 [物品]": "使用道具、穿戴配饰或撒化肥"
        }
    },
    "👑 称号系统 (收集)": {
        "icon": "🏷️",
        "cmds": {
            "/称号 抽奖": "消耗喵币抽取随机称号 (N~SSR)",
            "/称号 列表": "查看已拥有的称号",
            "/称号 佩戴 [名称]": "展示你的个性头衔"
        }
    }
}

def get_help_embed(bot_avatar_url):
    """
    生成帮助文档 Embed
    """
    embed = discord.Embed(
        title="📜 喵喵小镇居民指南", 
        description="欢迎来到喵喵小镇！这里是一个由猫咪主宰的模拟世界。\n以下是生存与致富的完全手册：",
        color=0xFFA500
    )
    embed.set_thumbnail(url=bot_avatar_url)
    
    # --- 新手引导区 ---
    embed.add_field(
        name="🔰 新手三步走", 
        value=(
            "1️⃣ **注册身份**：使用 `/市民 注册` 获得你的第一桶金。\n"
            "2️⃣ **原始积累**：去 `/农场 种植` 便宜的作物，或者去 `/大富翁 投骰子` 捡钱。\n"
            "3️⃣ **投资理财**：有钱后可以去 `/股市` 搏一搏，或者在 `/大富翁` 买地收租！"
        ),
        inline=False
    )

    # --- 详细指令区 ---
    for category, data in HELP_DATA.items():
        icon = data['icon']
        content = ""
        for cmd, desc in data['cmds'].items():
            content += f"`{cmd}`\n└ {desc}\n"
        
        embed.add_field(name=f"{icon} {category}", value=content, inline=False)
    
    # --- 底部提示 ---
    embed.set_footer(text="提示：大富翁破产会导致资产清算，股市融资需谨慎！ | Made with 🐱")
    
    return embed